import{c as f,d as b,_ as C}from "./index.7fe3d568.js";const E= c=>(Vue.pushScopeId("data-v-5e75738d"),c=c(),Vue.popScopeId(),c),F=E(()=>Vue.createElementVNode("div",{class:"UpdateAdmin"},null,-1)),A={class:"userInfo"},h={class:"permissionHead"},T={class:"header"},B={class:"permissionBody"},D={class:"body"},v={class:"select"},P={class:"pagination"},U=Vue.defineComponent({__name:"UpdateAdmin",setup(c){const{proxy:l}=Vue.getCurrentInstance(),r=f(),V=b();var n=Vue.reactive({search:null,Count:0,currentPage:1,limit:20,loading:null,init(){this.Count=0,this.currentPage=1,this.limit=20,this.loading=null},changePage: e=>{n.currentPage=e,p(),o.getAdminList()}});function p(){l.$router.replace({path:"/Admin/AdminEdit/UpdateAdmin",query:{Page:n.currentPage,Limit:n.limit}})}var o=Vue.reactive({list:[],Count:0,getAdminList:()=>{l.$get("/api/admin/permission/list/?Page="+(n.currentPage-1)+"&Limit="+n.limit).then(e=>{var u=e.data;if(u.code===0){console.log(e.data);const t=u.Data.map(a=>{const i={UID:a.UID,PermissionMap:a.PermissionMap,permissionTabel:[!1,!1,!1,!1,!1,!1]};return o.ParsePermission(i),i});o.list=t,o.Count=u.Count,n.Count=u.Count}})},ParsePermission(e){if(console.log(e),(e.PermissionMap&r.AdministratorBit)>0?e.permissionTabel[5]=!0:e.permissionTabel[5]=!1,(e.PermissionMap&r.ProblemAdminBit)>0?e.permissionTabel[5]=e.permissionTabel[4]=!0:e.permissionTabel[4]=!1,(e.PermissionMap&r.ListAdminBit)>0?e.permissionTabel[5]=e.permissionTabel[3]=!0:e.permissionTabel[3]=!1,(e.PermissionMap&r.ContestAdminBit)>0?e.permissionTabel[5]=e.permissionTabel[2]=!0:e.permissionTabel[2]=!1,(e.PermissionMap&r.SourceBorwserBit)>0?e.permissionTabel[5]=e.permissionTabel[1]=!0:e.permissionTabel[1]=!1,(e.PermissionMap&r.SuperAdminBit)>0)for(let u in e.permissionTabel)e.permissionTabel[u]=!0;else e.permissionTabel[0]=!1;console.log(e)},select(e, u){let t=e.permissionTabel[u];if(u==0&&t){for(let a in e.permissionTabel)e.permissionTabel[a]=!0;l.elMessage({message:"\u6CE8\u610F\uFF0C\u4F60\u5C06\u8D4B\u4E88 \u8D85\u7EA7\u7BA1\u7406\u5458 \u6743\u9650\uFF01",type:"warning"})}u==0&&!t&&V.UID==e.UID&&l.elMessage({message:"\u6CE8\u610F\uFF0C\u4F60\u5C06\u53D6\u6D88\u81EA\u5DF1\u7684 \u8D85\u7EA7\u7BA1\u7406\u5458 \u6743\u9650\uFF01",type:"warning"}),u!=0&&!t&&e.permissionTabel[0]&&l.elMessage({message:"\u6CE8\u610F\uFF0C\u4F60\u5C06\u53D6\u6D88 \u8D85\u7EA7\u7BA1\u7406\u5458 \u7684\u6B21\u7EA7\u6743\u9650\uFF0C\u8FD9\u53EF\u80FD\u662F\u65E0\u6548\u7684\uFF01",type:"warning"})},ChangePermission(e){console.log(e),l.$post("api/admin/permission/edit/",{UID:e.UID,SuperAdmin:e.permissionTabel[0],SourceAdmin:e.permissionTabel[1],ContestAdmin:e.permissionTabel[2],ListAdmin:e.permissionTabel[3],ProbelmAdmin:e.permissionTabel[4]}).then(u=>{var a,i;let t=u.data;t.code==0&&l.elMessage({message:"\u4FEE\u6539\u6210\u529F",type:"success"}),l.codeProcessor((a=t==null?void 0:t.code)!=null?a:100001,(i=t==null?void 0:t.msg)!=null?i:"\u670D\u52A1\u5668\u9519\u8BEF\\\\error")})}});return o.getAdminList(),(e, u)=>{const t=Vue.resolveComponent("el-switch"),a=Vue.resolveComponent("el-button"),i=Vue.resolveComponent("el-pagination");return Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[F,Vue.createElementVNode("div",A,[Vue.createElementVNode("div",h,[(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(["ID","\u8D85\u7BA1","\u8D44\u6E90","\u7ADE\u8D5B","\u9898\u5355","\u9898\u76EE","\u7BA1\u7406\u5458",""],(s, g)=>Vue.createElementVNode("div",T,Vue.toDisplayString(s),1)),64))]),Vue.createElementVNode("div",B,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(o).list,(s, g)=>(Vue.openBlock(),Vue.createElementBlock("div",D,[Vue.createElementVNode("div",null,Vue.toDisplayString(s.UID),1),(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(s.permissionTabel,(_, d)=>(Vue.openBlock(),Vue.createElementBlock("div",v,[Vue.createVNode(t,{modelValue:s.permissionTabel[d],"onUpdate:modelValue": m=>s.permissionTabel[d]=m,onChange: m=>Vue.unref(o).select(s,d),"active-value":!0,"inactive-value":!1},null,8,["modelValue","onUpdate:modelValue","onChange"])]))),256)),Vue.createVNode(a,{class:"botton",onClick: _=>Vue.unref(o).ChangePermission(s)},{default:Vue.withCtx(()=>[Vue.createTextVNode(" \u4FEE\u6539 ")]),_:2},1032,["onClick"])]))),256))])]),Vue.createElementVNode("div",P,[Vue.createVNode(i,{background:"",layout:"prev, pager, next","page-size":Vue.unref(n).limit,total:Vue.unref(n).Count,"current-page":Vue.unref(n).currentPage,onCurrentChange:Vue.unref(n).changePage},null,8,["page-size","total","current-page","onCurrentChange"])])],64)}}});const y=C(U,[["__scopeId","data-v-5e75738d"]]);export{y as default};
