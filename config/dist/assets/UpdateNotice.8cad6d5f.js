import{I as _,e as E,s as F,_ as N}from "./index.7fe3d568.js";const V= c=>(Vue.pushScopeId("data-v-0d24b04c"),c=c(),Vue.popScopeId(),c),D={class:"updateList"},C={class:"search"},w=V(()=>Vue.createElementVNode("span",{style:{width:"100px"}},"\u9898\u5355\u53F7\uFF1A",-1)),x={key:0,class:"table"},B={class:"addlist"},I=V(()=>Vue.createElementVNode("span",null,"\u516C\u544A\u6807\u9898",-1)),A=V(()=>Vue.createElementVNode("div",null,[Vue.createElementVNode("span",null,"\u516C\u544A\u5185\u5BB9:")],-1)),S={class:"markdown"},y={style:{display:"flex","justify-content":"flex-end",padding:"10px 0"}},k={class:"showList"},b={class:"list"},T=["checked","onChange"],$=["onClick"],L=Vue.defineComponent({__name:"UpdateNotice",setup(c){const{proxy:i}=Vue.getCurrentInstance();var f={toolbar:["bold","underline","italic","-","strikeThrough","title","sub","sup","quote","unorderedList","orderedList","-","codeRow","code","link","image","table","mermaid","katex","-","revoke","next","save","=","preview","htmlPreview","catalog"]},l=Vue.reactive({NID:1,isSearched:!1,onFocus(){l.isSearched=!1},getNoticeInfo(t){t&&(l.NID=t),i.$axios.get("/api/notice/"+l.NID).then(e=>{var o,a;let u=e.data;u.code==0?(r.copy(u),l.isSearched=!0):l.isSearched=!1,i.codeProcessor((o=u==null?void 0:u.code)!=null?o:100001,(a=u==null?void 0:u.msg)!=null?a:"\u670D\u52A1\u5668\u9519\u8BEF\\\\error")})}}),r=Vue.reactive({Title:"",Content:"",init(){r.Title="",r.Content=""},copy(t){r.Title=t.Title,r.Content=t.Content},updateImg: t=>{if(t.length==0){i.elMessage({message:"\u4E0A\u4F20\u5185\u5BB9\u4E3A\u7A7A\uFF01",type:"warning"});return}ElementPlus.ElMessageBox.confirm("\u786E\u5B9A\u4E0A\u4F20\u5417\uFF1F","\u6CE8\u610F",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{t.forEach(e=>{g(e)})})}});function g(t){_.problemImageCompress(t).then(e=>{e.code==0&&E.uploadProblemImage(e.data).then(u=>{var a,d;let o=u.data;if(o.code==0){let s=o.ImageURL;r.Content+=`
![](${F}${s})`,i.elMessage({message:`
              <strong>${t.name}\u4E0A\u4F20\u6210\u529F</strong><br/>
              <span>\u5DF2\u538B\u7F29:${(t.size/1024).toFixed(2)}KB->${(e.data.size/1024).toFixed(2)}KB</span>
            `,type:"success",duration:5e3,dangerouslyUseHTMLString:!0})}i.codeProcessor((a=o==null?void 0:o.code)!=null?a:100001,(d=o==null?void 0:o.msg)!=null?d:"\u670D\u52A1\u5668\u9519\u8BEF\\\\error")})})}function h(){i.$axios.put("/api/notice/"+l.NID,{title:r.Title,content:r.Content}).then(t=>{var u,o;let e=t.data;e.code==0?i.elMessage({message:"\u4FEE\u6539\u6210\u529F!",type:"success"}):i.codeProcessor((u=e==null?void 0:e.code)!=null?u:100001,(o=e==null?void 0:e.msg)!=null?o:"\u670D\u52A1\u5668\u9519\u8BEF\\\\error")})}function p(t){l.NID=t||l.NID,i.$delete("/api/notice/"+l.NID).then(e=>{var o,a;let u=e.data;u.code==0?i.elMessage({message:"\u5220\u9664\u6210\u529F!",type:"success"}):i.codeProcessor((o=u==null?void 0:u.code)!=null?o:100001,(a=u==null?void 0:u.msg)!=null?a:"\u670D\u52A1\u5668\u9519\u8BEF\\\\error")})}var n=Vue.reactive({Data:[],isShowed:!1,selectAlled:!1,init(){this.Data=[]},showList:()=>{n.isShowed?n.isShowed=!1:(n.isShowed=!0,n.search())},search:()=>{i.$get("api/notices").then(t=>{var u,o;let e=t.data;e.code==0&&(n.Data=e.data,n.Data.forEach(a=>{a.selected=!1}),n.isShowed=!0,n.selectAlled=!1),i.codeProcessor((u=e==null?void 0:e.code)!=null?u:100001,(o=e==null?void 0:e.msg)!=null?o:"\u670D\u52A1\u5668\u9519\u8BEF\\\\error")})},selectList:t=>{n.Data[t].selected=!n.Data[t].selected},selectAll:()=>{n.selectAlled=!n.selectAlled,n.Data.forEach(t=>{t.selected=n.selectAlled})},batchDelete:()=>{let t=[],e="";if(n.Data.forEach(u=>{u.selected&&(t.push(u.ID),e+=u.ID+",")}),t.length<=0){i.elMessage({message:"\u672A\u9009\u62E9\u4EFB\u4F55\u9898\u5355\uFF01",type:"warning"});return}ElementPlus.ElMessageBox.confirm("\u786E\u5B9A\u8981\u6279\u91CF\u5220\u9664\u516C\u544AID\u4E3A "+e+" \u516C\u544A\u5417\uFF1F","\u6CE8\u610F",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{for(let u in t)i.elMessage({message:"\u6B63\u5728\u5220\u9664\u516C\u544A"+t[u],type:"success"}),p(t[u]);i.elMessage({message:"\u6279\u91CF\u5220\u9664\u6210\u529F!",type:"success"}),n.isShowed=!1})}});return Vue.onMounted(()=>{var t=i.$route.query.LID;t&&(l.LID=t,l.getListInfo(t))}),(t,e)=>{const u=Vue.resolveComponent("el-input-number"),o=Vue.resolveComponent("el-button"),a=Vue.resolveComponent("el-divider"),d=Vue.resolveComponent("el-input");return Vue.openBlock(),Vue.createElementBlock("div",D,[Vue.createElementVNode("div",C,[w,Vue.createVNode(u,{modelValue:Vue.unref(l).NID,"onUpdate:modelValue":e[0]||(e[0]=s=>Vue.unref(l).NID=s),min:0,style:{width:"200px"},onFocus:e[1]||(e[1]=s=>Vue.unref(l).onFocus())},null,8,["modelValue"]),Vue.createVNode(o,{plain:"",onClick:e[2]||(e[2]=s=>Vue.unref(l).getNoticeInfo(null))},{default:Vue.withCtx(()=>[Vue.createTextVNode("\u641C\u7D22")]),_:1})]),Vue.createVNode(a),Vue.unref(l).isSearched?(Vue.openBlock(),Vue.createElementBlock("div",x,[Vue.createElementVNode("div",B,[Vue.createElementVNode("div",null,[I,Vue.createVNode(d,{modelValue:Vue.unref(r).Title,"onUpdate:modelValue":e[3]||(e[3]=s=>Vue.unref(r).Title=s)},null,8,["modelValue"])]),A,Vue.createElementVNode("div",S,[Vue.createVNode(Vue.unref(MdEditorV3),{modelValue:Vue.unref(r).Content,"onUpdate:modelValue":e[4]||(e[4]=s=>Vue.unref(r).Content=s),toolbars:Vue.unref(f).toolbar,"on-upload-img":Vue.unref(r).updateImg},null,8,["modelValue","toolbars","on-upload-img"])]),Vue.createElementVNode("div",y,[Vue.createVNode(o,{plain:"",onClick:e[5]||(e[5]=s=>h())},{default:Vue.withCtx(()=>[Vue.createTextVNode("\u66F4\u65B0")]),_:1}),Vue.createVNode(o,{plain:"",onClick:e[6]||(e[6]=s=>p(Vue.unref(l).NID))},{default:Vue.withCtx(()=>[Vue.createTextVNode("\u5220\u9664")]),_:1})])])])):Vue.createCommentVNode("",!0),Vue.createElementVNode("div",k,[Vue.createVNode(o,{plain:"",onClick:e[7]||(e[7]=s=>Vue.unref(n).showList())},{default:Vue.withCtx(()=>[Vue.createTextVNode(Vue.toDisplayString(Vue.unref(n).isShowed?"\u5173\u95ED\u5217\u8868":"\u663E\u793A\u5217\u8868"),1)]),_:1}),Vue.withDirectives(Vue.createVNode(o,{plain:"",onClick:e[8]||(e[8]=s=>Vue.unref(n).selectAll())},{default:Vue.withCtx(()=>[Vue.createTextVNode(" \u5F53\u9875\u5168\u9009 ")]),_:1},512),[[Vue.vShow,Vue.unref(n).isShowed]]),Vue.withDirectives(Vue.createVNode(o,{plain:"",type:"warning",onClick:e[9]||(e[9]=s=>Vue.unref(n).batchDelete())},{default:Vue.withCtx(()=>[Vue.createTextVNode(" \u6279\u91CF\u5220\u9664 ")]),_:1},512),[[Vue.vShow,Vue.unref(n).isShowed]])]),Vue.withDirectives(Vue.createElementVNode("div",b,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(n).Data,(s,m)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:Vue.normalizeClass(s.selected?"item itemSelected":"item"),key:m},[Vue.createElementVNode("input",{type:"checkbox",checked:s.selected,onChange:Vue.withModifiers(v=>Vue.unref(n).selectList(m),["stop"])},null,40,T),Vue.createElementVNode("div",{class:"title cursor_pointer",onClick:Vue.withModifiers(v=>Vue.unref(l).getNoticeInfo(s.ID),["stop"])},Vue.toDisplayString(s.ID)+"\xA0-\xA0"+Vue.toDisplayString(s.Title),9,$)],2))),128))],512),[[Vue.vShow,Vue.unref(n).isShowed]])])}}});const U=N(L,[["__scopeId","data-v-0d24b04c"]]);export{U as default};
