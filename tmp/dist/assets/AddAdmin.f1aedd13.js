import{c as V,d as f,_ as F}from"./index.de99a551.js";const D=a=>(Vue.pushScopeId("data-v-c01f7cd4"),a=a(),Vue.popScopeId(),a),A={class:"AddAdmin"},E={class:"input"},_=D(()=>Vue.createElementVNode("span",null,"UID\uFF1A",-1)),b={class:"userInfo"},g={class:"permissionTabel"},T={class:"header"},C={class:"select"},B=Vue.defineComponent({__name:"AddAdmin",setup(a){const{proxy:o}=Vue.getCurrentInstance(),r=V(),p=f();var e=Vue.reactive({UID:"",Adept:"",Classes:"",Email:"",Major:"",School:"",UserName:"",Vjid:"",PermissionMap:0,permissionTabel:[!1,!1,!1,!1,!1,!1],isSearched:!1,copy:s=>{e.UID=s.UID,e.Adept=s.Adept,e.Classes=s.Classes,e.Email=s.Email,e.Major=s.Major,e.School=s.School,e.UserName=s.UserName,e.Vjid=s.Vjid},getInfo:async()=>{if(!e.UID){o.elMessage({message:"\u8F93\u5165\u7684UID\u4E0D\u80FD\u4E3A\u7A7A!",type:"warning"});return}o.$get("api/user/info?UID="+e.UID).then(s=>{var i,n;let u=s.data;if(u.code==0)e.copy(u),o.$get("api/admin/permission/"+e.UID).then(m=>{let t=m.data;if(t.code==0)if(e.PermissionMap=Number(t.PermissionMap),e.isSearched=!0,(e.PermissionMap&r.AdministratorBit)>0?e.permissionTabel[5]=!0:e.permissionTabel[5]=!1,(e.PermissionMap&r.ProblemAdminBit)>0?e.permissionTabel[5]=e.permissionTabel[4]=!0:e.permissionTabel[4]=!1,(e.PermissionMap&r.ListAdminBit)>0?e.permissionTabel[5]=e.permissionTabel[3]=!0:e.permissionTabel[3]=!1,(e.PermissionMap&r.ContestAdminBit)>0?e.permissionTabel[5]=e.permissionTabel[2]=!0:e.permissionTabel[2]=!1,(e.PermissionMap&r.SourceBorwserBit)>0?e.permissionTabel[5]=e.permissionTabel[1]=!0:e.permissionTabel[1]=!1,(e.PermissionMap&r.SuperAdminBit)>0)for(let l in e.permissionTabel)e.permissionTabel[l]=!0;else e.permissionTabel[0]=!1});else{o.codeProcessor((i=u==null?void 0:u.code)!=null?i:100001,(n=u==null?void 0:u.msg)!=null?n:"\u670D\u52A1\u5668\u9519\u8BEF\\\\error");return}})},select:s=>{let u=e.permissionTabel[s];if(s==0&&u){for(let i in e.permissionTabel)e.permissionTabel[i]=!0;o.elMessage({message:"\u6CE8\u610F\uFF0C\u4F60\u5C06\u8D4B\u4E88 \u8D85\u7EA7\u7BA1\u7406\u5458 \u6743\u9650\uFF01",type:"warning"})}s==0&&!u&&p.UID==e.UID&&o.elMessage({message:"\u6CE8\u610F\uFF0C\u4F60\u5C06\u53D6\u6D88\u81EA\u5DF1\u7684 \u8D85\u7EA7\u7BA1\u7406\u5458 \u6743\u9650\uFF01",type:"warning"}),s!=0&&!u&&e.permissionTabel[0]&&o.elMessage({message:"\u6CE8\u610F\uFF0C\u4F60\u5C06\u53D6\u6D88 \u8D85\u7EA7\u7BA1\u7406\u5458 \u7684\u6B21\u7EA7\u6743\u9650\uFF0C\u8FD9\u53EF\u80FD\u662F\u65E0\u6548\u7684\uFF01",type:"warning"})}});function d(){o.$post("api/admin/permission/edit/",{UID:e.UID,SuperAdmin:e.permissionTabel[0],SourceAdmin:e.permissionTabel[1],ContestAdmin:e.permissionTabel[2],ProbelmAdmin:e.permissionTabel[4]}).then(s=>{var i,n;let u=s.data;u.code==0&&o.elMessage({message:"\u4FEE\u6539\u6210\u529F",type:"success"}),o.codeProcessor((i=u==null?void 0:u.code)!=null?i:100001,(n=u==null?void 0:u.msg)!=null?n:"\u670D\u52A1\u5668\u9519\u8BEF\\\\error")})}return(s,u)=>{const i=Vue.resolveComponent("el-input"),n=Vue.resolveComponent("el-button"),m=Vue.resolveComponent("el-switch");return Vue.openBlock(),Vue.createElementBlock("div",A,[Vue.createElementVNode("div",E,[_,Vue.createVNode(i,{modelValue:Vue.unref(e).UID,"onUpdate:modelValue":u[0]||(u[0]=t=>Vue.unref(e).UID=t),onFocus:u[1]||(u[1]=()=>{Vue.unref(e).isSearched=!1})},null,8,["modelValue"])]),Vue.createVNode(n,{onClick:Vue.unref(e).getInfo},{default:Vue.withCtx(()=>[Vue.createTextVNode("\u641C\u7D22")]),_:1},8,["onClick"]),Vue.withDirectives(Vue.createElementVNode("div",b,[Vue.createElementVNode("div",null,"\u7528\u6237\u540D\uFF1A"+Vue.toDisplayString(Vue.unref(e).UID),1),Vue.createElementVNode("div",null,"\u6635\u79F0\uFF1A"+Vue.toDisplayString(Vue.unref(e).UserName),1),Vue.createElementVNode("div",null,"\u5B66\u6821\uFF1A"+Vue.toDisplayString(Vue.unref(e).School),1),Vue.createElementVNode("div",null,"\u73ED\u7EA7\uFF1A"+Vue.toDisplayString(Vue.unref(e).Classes),1),Vue.createElementVNode("div",null,"\u90AE\u7BB1\uFF1A"+Vue.toDisplayString(Vue.unref(e).Email),1),Vue.createElementVNode("div",g,[(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(["\u8D85\u7BA1","\u8D44\u6E90","\u7ADE\u8D5B","\u9898\u5355","\u9898\u76EE","\u7BA1\u7406\u5458"],(t,l)=>Vue.createElementVNode("div",T,Vue.toDisplayString(t),1)),64)),(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(e).permissionTabel,(t,l)=>(Vue.openBlock(),Vue.createElementBlock("div",C,[Vue.createVNode(m,{modelValue:Vue.unref(e).permissionTabel[l],"onUpdate:modelValue":c=>Vue.unref(e).permissionTabel[l]=c,onChange:c=>Vue.unref(e).select(l),"active-value":!0,"inactive-value":!1},null,8,["modelValue","onUpdate:modelValue","onChange"])]))),256))]),Vue.createVNode(n,{onClick:d},{default:Vue.withCtx(()=>[Vue.createTextVNode("\u4FEE\u6539")]),_:1})],512),[[Vue.vShow,Vue.unref(e).isSearched]])])}}});const v=F(B,[["__scopeId","data-v-c01f7cd4"]]);export{v as default};
