import{E as h,J as v,j as E,_ as U}from"./index.7fe3d568.js";import{I as r}from"./Input.962aec76.js";const n=i=>(Vue.pushScopeId("data-v-cdb113b3"),i=i(),Vue.popScopeId(),i),f={class:"BatchAddUser"},F=n(()=>Vue.createElementVNode("div",{class:"el-upload__text"},[Vue.createTextVNode(" \u4EE5Json\u3001Excel\uFF08xlsx\uFF09\u683C\u5F0F\u6587\u4EF6\u4E0A\u4F20\u7528\u6237\u6570\u636E "),Vue.createElementVNode("em",null,"\u70B9\u51FB"),Vue.createTextVNode("\u6216\u8005"),Vue.createElementVNode("em",null,"\u62D6\u62FD")],-1)),x=n(()=>Vue.createElementVNode("div",{class:"example"},[Vue.createElementVNode("div",{class:"title"}," \u67E5\u770BJson\u793A\u4F8B\u6570\u636E "),Vue.createElementVNode("pre",{class:"exampleText"},`    [
      {
        "UID": "12345",
        "UserName": "13\u4E1C\u6708\u5173",
        "Pass": "123"
      },
      {
        "UID": "45678",
        "UserName": "13\u4E1C\u6708\u5173",
        "Pass": "123"
      },
      {
        "UID": "78912",
        "UserName": "13\u4E1C\u6708\u5173",
        "Pass": "123"
      }
    ]`)],-1)),C={class:"setColumnName"},D=n(()=>Vue.createElementVNode("div",{class:"title"}," \u81EA\u5B9A\u4E49\u5217\u540D ",-1)),y=n(()=>Vue.createElementVNode("div",null,"UID\u5217\u540D",-1)),I=n(()=>Vue.createElementVNode("div",null,"UserName\u5217\u540D",-1)),g=n(()=>Vue.createElementVNode("div",null,"Pass\u5217\u540D",-1)),w={class:"userList"},b=Vue.createStaticVNode('<div class="header" data-v-cdb113b3><div style="width:240px;" data-v-cdb113b3>\u7528\u6237\u540D</div><div style="width:240px;" data-v-cdb113b3>\u6635\u79F0</div><div style="width:240px;" data-v-cdb113b3>\u5BC6\u7801</div><div style="width:60px;" data-v-cdb113b3>\u64CD\u4F5C</div></div>',1),B={style:{width:"240px"}},P={style:{width:"240px"}},A={style:{width:"240px"}},S=Vue.defineComponent({__name:"BatchAddUser",setup(i){const{proxy:a}=Vue.getCurrentInstance(),e=Vue.reactive({list:[],columnName:{UID:"UID",UserName:"UserName",Pass:"Pass"},showList:!1,remove(s){for(let t in this.list)s==t&&this.list.splice(t,1)},init:()=>{e.list=[],e.showList=!1}});function V(s,t){let u=t[0].raw;switch(u.type){case"application/json":v.getContentFromJson(u).then(l=>{p(l)});break;case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":h.getContentFromExcel(u).then(l=>{N(l)});break}}function p(s){e.init(),a.$refs.upload.clearFiles();for(let t of s.data){if(!t[e.columnName.UID]||!t[e.columnName.UserName]||!t[e.columnName.Pass]){a.elMessage({message:"\u8BE5\u6587\u4EF6\u6570\u636E\u683C\u5F0F\u4E0D\u89C4\u8303\uFF0C\u95EE\u9898\u884C\uFF1A"+JSON.stringify(t),type:"error"}),e.init();return}let u=t[e.columnName.UID],l=t[e.columnName.UserName],d=t[e.columnName.Pass];e.list.push({UID:u,UserName:l,Pass:d})}e.showList=!0}function N(s){a.$refs.upload.clearFiles();for(let t of s.data)for(let u of t){if(!u[e.columnName.UID]||!u[e.columnName.UserName]||!u[e.columnName.Pass]){a.elMessage({message:"\u6570\u636E\u51FA\u73B0\u95EE\u9898\uFF0C\u884C\u5185\u5BB9\uFF1A"+JSON.stringify(u),type:"error"}),e.init();return}let l=u[e.columnName.UID],d=u[e.columnName.UserName],c=u[e.columnName.Pass];e.list.push({UID:l,UserName:d,Pass:c})}e.showList=!0}function _(){let s=[];for(let t in e.list)s.push({UID:String(e.list[t].UID),UserName:String(e.list[t].UserName),Pass:String(e.list[t].Pass)});a.$post("api/admin/users",s,1).then(t=>{let u=t.data;u.code==0&&a.elMessage({message:"\u6279\u91CF\u6DFB\u52A0\u6210\u529F!",type:"success"}),E(u.code,u.msg)})}return(s,t)=>{const u=Vue.resolveComponent("upload-filled"),l=Vue.resolveComponent("el-icon"),d=Vue.resolveComponent("el-upload"),c=Vue.resolveComponent("el-button");return Vue.openBlock(),Vue.createElementBlock("div",f,[Vue.createVNode(d,{ref:"upload",class:"uploadJson",drag:"",accept:".json,.xlsx","auto-upload":!1,"on-change":V,"show-file-list":!0},{default:Vue.withCtx(()=>[Vue.createVNode(l,{class:"el-icon--upload"},{default:Vue.withCtx(()=>[Vue.createVNode(u)]),_:1}),F]),_:1},512),x,Vue.createElementVNode("div",C,[D,y,Vue.createVNode(r,{modelValue:e.columnName.UID,"onUpdate:modelValue":t[0]||(t[0]=o=>e.columnName.UID=o)},null,8,["modelValue"]),I,Vue.createVNode(r,{modelValue:e.columnName.UserName,"onUpdate:modelValue":t[1]||(t[1]=o=>e.columnName.UserName=o)},null,8,["modelValue"]),g,Vue.createVNode(r,{modelValue:e.columnName.Pass,"onUpdate:modelValue":t[2]||(t[2]=o=>e.columnName.Pass=o)},null,8,["modelValue"])]),Vue.withDirectives(Vue.createElementVNode("div",w,[b,(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.list,(o,m)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"item",key:m},[Vue.createElementVNode("div",B,Vue.toDisplayString(o.UID),1),Vue.createElementVNode("div",P,Vue.toDisplayString(o.UserName),1),Vue.createElementVNode("div",A,Vue.toDisplayString(o.Pass),1),Vue.createVNode(c,{style:{width:"60px"},type:"danger",onClick:k=>e.remove(m)},{default:Vue.withCtx(()=>[Vue.createTextVNode(" \u5220\u9664 ")]),_:2},1032,["onClick"])]))),128)),Vue.createVNode(c,{class:"btn",type:"primary",onClick:t[3]||(t[3]=o=>_())},{default:Vue.withCtx(()=>[Vue.createTextVNode(" \u63D0\u4EA4\u5217\u8868 ")]),_:1})],512),[[Vue.vShow,e.showList]])])}}});const T=U(S,[["__scopeId","data-v-cdb113b3"]]);export{T as default};
