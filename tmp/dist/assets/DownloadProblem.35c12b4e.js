import{c as f,I as w,e as C,s as I,_ as v}from"./index.7fe3d568.js";const _=h=>(Vue.pushScopeId("data-v-543161ee"),h=h(),Vue.popScopeId(),h),F={class:"search"},P=_(()=>Vue.createElementVNode("span",{style:{width:"70px"}},"\u9898\u53F7\uFF1A",-1)),O=_(()=>Vue.createElementVNode("div",{style:{color:"red","text-align":"center","font-size":"15px"}},"\xA0\xA0\u9898\u76EE\u95F4\u4EE5\u9017\u53F7\u9694\u5F00",-1)),L={class:"showList"},b={class:"list"},S=["checked","onChange"],B=["onClick"],N={class:"pagination"},A=Vue.defineComponent({__name:"DownloadProblem",setup(h){const{proxy:p}=Vue.getCurrentInstance(),s=f();var r=Vue.reactive({PID:"",isSearched:!1,onFocus(){r.isSearched=!1},DownloadProblem(e){e&&(r.PID=e),p.$axios.get("api/file/json/download?PIDs="+r.PID).then(t=>{var n,c;let u=t.data;if(console.log(u),t.downloa,typeof u.code<"u")p.codeProcessor((n=u==null?void 0:u.code)!=null?n:100001,(c=u==null?void 0:u.msg)!=null?c:"\u670D\u52A1\u5668\u9519\u8BEF\\\\error");else{let V=Date.now()+".json";const d=new Blob([JSON.stringify(u,null,"	")]),m=window.URL.createObjectURL(d);console.log(d),console.log(m);const l=document.createElement("a");l.href=m,l.download=V,l.click(),window.URL.revokeObjectURL(m)}})}}),i=Vue.reactive({PID:"",Title:"",Description:"",Input:"",Output:"",SampleInput:"",SampleOutput:"",LimitTime:0,LimitMemory:0,Hit:"",Label:"",Origin:-1,OriginPID:"",ContentType:-1,Visible:1,ContentTypes:[{label:"\u666E\u901A ",value:s.PROBLEM_CONTENTTYPE_NORMAL},{label:"MarkDown",value:s.PROBLEM_CONTENTTYPE_MARKDOWN}],Origins:[{label:"\u672C\u5730",value:s.PROBLEM_ORIGIN_LOCAL},{label:"CodeForce",value:s.PROBLEM_ORIGIN_CF},{label:"AtCoder",value:s.PROBLEM_ORIGIN_ATCODER},{label:"\u6D1B\u8C37",value:s.PROBLEM_ORIGIN_LUOGU}],OriginPlaceHolder:{[s.PROBLEM_ORIGIN_CF]:"\u7ADE\u8D5BID + \u9898\u76EE\u7F16\u53F7 \u5982\uFF1A1069A",[s.PROBLEM_ORIGIN_ATCODER]:"\u7ADE\u8D5BID + \u9898\u76EE\u7F16\u53F7 \u5982\uFF1Aabc277_e"},Visibles:[{label:"\u53EF\u89C1",value:s.PROBLEM_VISIBLE},{label:"\u4E0D\u53EF\u89C1",value:s.PROBLEM_UNVISIBLE}],init(){r.isSearched=!1,this.PID=0,this.Title="",this.Description="",this.Input="",this.Output="",this.SampleInput="",this.SampleOutput="",this.LimitTime=0,this.LimitMemory=0,this.Hit="",this.Label="",this.Origin=0,this.OriginPID="",this.ContentType=-1,this.Visible=1},copy(e){i.PID=e.PID,i.Description=e.Description,i.Hit=e.Hit,i.Input=e.Input,i.LimitMemory=e.LimitMemory,i.LimitTime=e.LimitTime,i.Output=e.Output,i.SampleInput=e.SampleInput,i.SampleOutput=e.SampleOutput,i.Title=e.Title,i.Label=e.Label,i.Origin=e.Origin,i.OriginPID=e.OriginPID,i.ContentType=e.ContentType,i.Visible=e.Visible},updateImg:e=>{if(e.length==0){p.elMessage({message:"\u4E0A\u4F20\u5185\u5BB9\u4E3A\u7A7A\uFF01",type:"warning"});return}ElementPlus.ElMessageBox.confirm("\u786E\u5B9A\u4E0A\u4F20\u5417\uFF1F","\u6CE8\u610F",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{e.forEach(t=>{D(t)})})}}),a=Vue.reactive({Count:0,currentPage:1,limit:20,init(){a.Count=0,a.currentPage=1,a.limit=20}}),o=Vue.reactive({Data:[],isShowed:!1,init(){this.Data=[]},showList:()=>{o.isShowed?o.isShowed=!1:(o.isShowed=!0,o.search())},search:()=>{p.$get("api/problem/list?Page="+(a.currentPage-1)+"&Limit="+a.limit).then(e=>{var u,n;let t=e.data;t.code==0&&(a.Count=t.Count,o.Data=t.Data,o.Data.forEach(c=>{c.selected=!1}),o.isShowed=!0),p.codeProcessor((u=t==null?void 0:t.code)!=null?u:100001,(n=t==null?void 0:t.msg)!=null?n:"\u670D\u52A1\u5668\u9519\u8BEF\\\\error")})},changePage:e=>{a.currentPage=e,o.search()},selectProblem:e=>{o.Data[e].selected=!o.Data[e].selected},selectAll:()=>{o.Data.forEach(e=>{e.selected=!0})},Downloads:()=>{let e=[],t="";o.Data.forEach(u=>{u.selected&&e.push(u.PID)});for(let u=0;u<e.length;u++)t+=e[u],u!=e.length-1&&(t+=",");if(e.length<=0){p.elMessage({message:"\u672A\u9009\u62E9\u4EFB\u4F55\u9898\u76EE\uFF01",type:"warning"});return}r.DownloadProblem(t)}});function D(e){w.problemImageCompress(e).then(t=>{t.code==0&&C.uploadProblemImage(t.data).then(u=>{var c,V;let n=u.data;if(n.code==0){let d=n.ImageURL;i.Description+=`
![](${I}${d})`,p.elMessage({message:`
              <strong>${e.name}\u4E0A\u4F20\u6210\u529F</strong><br/>
              <span>\u5DF2\u538B\u7F29:${(e.size/1024).toFixed(2)}KB->${(t.data.size/1024).toFixed(2)}KB</span>
            `,type:"success",duration:5e3,dangerouslyUseHTMLString:!0})}p.codeProcessor((c=n==null?void 0:n.code)!=null?c:100001,(V=n==null?void 0:n.msg)!=null?V:"\u670D\u52A1\u5668\u9519\u8BEF\\\\error")})})}return(e,t)=>{const u=Vue.resolveComponent("el-input"),n=Vue.resolveComponent("el-button"),c=Vue.resolveComponent("el-divider"),V=Vue.resolveComponent("el-pagination"),d=Vue.resolveComponent("el-main"),m=Vue.resolveComponent("el-container");return Vue.openBlock(),Vue.createBlock(m,null,{default:Vue.withCtx(()=>[Vue.createVNode(d,{class:"Container"},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",F,[P,Vue.createVNode(u,{modelValue:Vue.unref(r).PID,"onUpdate:modelValue":t[0]||(t[0]=l=>Vue.unref(r).PID=l),style:{width:"200px"},onFocus:t[1]||(t[1]=l=>Vue.unref(r).onFocus())},null,8,["modelValue"]),Vue.createVNode(n,{plain:"",onClick:t[2]||(t[2]=l=>Vue.unref(r).DownloadProblem(null))},{default:Vue.withCtx(()=>[Vue.createTextVNode("\u4E0B\u8F7D")]),_:1}),O]),Vue.createVNode(c),Vue.createElementVNode("div",L,[Vue.createVNode(n,{plain:"",onClick:t[3]||(t[3]=l=>Vue.unref(o).showList())},{default:Vue.withCtx(()=>[Vue.createTextVNode(Vue.toDisplayString(Vue.unref(o).isShowed?"\u5173\u95ED\u5217\u8868":"\u663E\u793A\u5217\u8868"),1)]),_:1}),Vue.withDirectives(Vue.createVNode(n,{plain:"",onClick:t[4]||(t[4]=l=>Vue.unref(o).selectAll())},{default:Vue.withCtx(()=>[Vue.createTextVNode(" \u5F53\u9875\u5168\u9009 ")]),_:1},512),[[Vue.vShow,Vue.unref(o).isShowed]]),Vue.withDirectives(Vue.createVNode(n,{plain:"",type:"warning",onClick:t[5]||(t[5]=l=>Vue.unref(o).Downloads())},{default:Vue.withCtx(()=>[Vue.createTextVNode(" \u6279\u91CF\u4E0B\u8F7D ")]),_:1},512),[[Vue.vShow,Vue.unref(o).isShowed]])]),Vue.withDirectives(Vue.createElementVNode("div",b,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(o).Data,(l,g)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:Vue.normalizeClass(l.selected?"item itemSelected":"item"),key:g},[Vue.createElementVNode("input",{type:"checkbox",checked:l.selected,onChange:Vue.withModifiers(E=>Vue.unref(o).selectProblem(g),["stop"])},null,40,S),Vue.createElementVNode("div",{class:"title cursor_pointer",onClick:Vue.withModifiers(E=>Vue.unref(r).DownloadProblem(l.PID),["stop"])},Vue.toDisplayString(l.PID)+"\xA0-\xA0"+Vue.toDisplayString(l.Title),9,B)],2))),128))],512),[[Vue.vShow,Vue.unref(o).isShowed]]),Vue.withDirectives(Vue.createElementVNode("div",N,[Vue.createVNode(V,{background:"",layout:"prev, pager, next","page-size":Vue.unref(a).limit,total:Vue.unref(a).Count,"current-page":Vue.unref(a).currentPage,onCurrentChange:Vue.unref(o).changePage},null,8,["page-size","total","current-page","onCurrentChange"])],512),[[Vue.vShow,Vue.unref(o).isShowed]])]),_:1})]),_:1})}}});const x=v(A,[["__scopeId","data-v-543161ee"]]);export{x as default};
