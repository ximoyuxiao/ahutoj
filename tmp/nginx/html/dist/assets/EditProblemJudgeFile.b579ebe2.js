import{f as h,_ as D}from"./index.de99a551.js";const m=V=>(Vue.pushScopeId("data-v-c1be3697"),V=V(),Vue.popScopeId(),V),B={class:"EditProblemJudgeFile"},N={class:"search"},C=m(()=>Vue.createElementVNode("span",{style:{width:"70px"}},"\u9898\u53F7\uFF1A",-1)),x={class:"preview"},y={class:"fileList"},P=m(()=>Vue.createElementVNode("div",{class:"header"},[Vue.createElementVNode("div",null,"\u6587\u4EF6\u540D"),Vue.createElementVNode("div",null,"\u7C7B\u578B"),Vue.createElementVNode("div",null,"\u5927\u5C0F"),Vue.createElementVNode("div",null,"\u64CD\u4F5C")],-1)),w={id:"notFound"},A=m(()=>Vue.createElementVNode("div",{class:"el-upload__text"},[Vue.createTextVNode(" \u4EE5zip\u3001in\u3001out\u683C\u5F0F\u6587\u4EF6\u4E0A\u4F20 "),Vue.createElementVNode("em",null,"\u70B9\u51FB"),Vue.createTextVNode("\u6216\u8005"),Vue.createElementVNode("em",null,"\u62D6\u62FD")],-1)),k=Vue.defineComponent({__name:"EditProblemJudgeFile",setup(V){const{proxy:n}=Vue.getCurrentInstance();var c=Vue.ref([]),i=Vue.ref([]),a=Vue.reactive({PID:"",isSearched:!0,onFocus(){a.isSearched=!0},getProblem(e){e&&(a.PID=e),n.$get("api/file/"+a.PID).then(t=>{i.value=[],c.value=[];let u=t.data;u.code==0&&(i.value=u.Data),u.Data||n.elMessage({message:"\u6682\u65E0\u6587\u4EF6",type:"info"}),a.isSearched=!0})}});function F(e,t){c.value=[],t.forEach(o=>{c.value.push(o)});let u=t[t.length-1].name;i.value.forEach(o=>{if(u==o.Filename){n.elMessage({message:o.Filename+" \u5DF2\u5B58\u5728\uFF0C\u5C06\u4F1A\u8986\u76D6\u539F\u6587\u4EF6!",type:"warning"});return}})}function E(e,t){c.value=[],t.forEach(u=>{c.value.push(u)}),n.elMessage({message:"\u53D6\u6D88\u4E0A\u4F20 "+e.name,type:"success"})}function v(){if(c.value.length==0){n.elMessage({message:"\u4E0A\u4F20\u5217\u8868\u4E3A\u7A7A\uFF01",type:"warning"});return}ElementPlus.ElMessageBox.confirm("\u786E\u5B9A\u4E0A\u4F20\u5417\uFF1F","\u6CE8\u610F",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{c.value.forEach(e=>{e=e.raw,h.uploadProblemJudgeFile(e,a.PID).then(t=>{var o,l;let u=t.data;if(u.code==0){for(let s in i.value)if(i.value[s].Filename==e.name){i.value.splice(Number(s),1);break}i.value.push({Filename:e.name,FileType:e.name.split(".")[1],FileSize:e.size}),n.elMessage({message:e.name+" \u4E0A\u4F20\u6210\u529F!",type:"success"})}n.codeProcessor((o=u==null?void 0:u.code)!=null?o:100001,(l=u==null?void 0:u.msg)!=null?l:"\u670D\u52A1\u5668\u9519\u8BEF\\\\error")})}),n.$refs.upload.clearFiles()})}function _(e){let t=i.value[e].Filename;ElementPlus.ElMessageBox.confirm("\u786E\u5B9A\u89E3\u538B "+t+" \u5417\uFF1F","\u6CE8\u610F",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{let u=new FormData;u.append("file",t),n.$post("api/file/unzip/"+a.PID,u,2).then(o=>{var s,d;console.log(o);let l=o.data;l.code==0&&(a.getProblem(a.PID),n.elMessage({message:"\u89E3\u538B\u6210\u529F",type:"success"})),n.codeProcessor((s=l==null?void 0:l.code)!=null?s:100001,(d=l==null?void 0:l.msg)!=null?d:"\u670D\u52A1\u5668\u9519\u8BEF\\\\error")})})}function f(e){let t=i.value[e].Filename;ElementPlus.ElMessageBox.confirm("\u786E\u5B9A\u5220\u9664 "+t+" \u5417\uFF1F","\u6CE8\u610F",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{let u=new FormData;u.append("file",t),n.$delete("api/file/"+a.PID,u).then(o=>{var s,d;let l=o.data;l.code==0&&(i.value.splice(e,1),n.elMessage({message:"\u5220\u9664\u6210\u529F",type:"success"})),n.codeProcessor((s=l==null?void 0:l.code)!=null?s:100001,(d=l==null?void 0:l.msg)!=null?d:"\u670D\u52A1\u5668\u9519\u8BEF\\\\error")})})}return Vue.onMounted(()=>{var e=n.$route.query.PID;e&&a.getProblem(e)}),(e,t)=>{const u=Vue.resolveComponent("el-input"),o=Vue.resolveComponent("el-button"),l=Vue.resolveComponent("upload-filled"),s=Vue.resolveComponent("el-icon"),d=Vue.resolveComponent("el-upload");return Vue.openBlock(),Vue.createElementBlock("div",B,[Vue.createElementVNode("div",N,[C,Vue.createVNode(u,{modelValue:Vue.unref(a).PID,"onUpdate:modelValue":t[0]||(t[0]=r=>Vue.unref(a).PID=r),style:{width:"200px"},onFocus:t[1]||(t[1]=r=>Vue.unref(a).onFocus())},null,8,["modelValue"]),Vue.createVNode(o,{plain:"",onClick:t[2]||(t[2]=r=>Vue.unref(a).getProblem(null))},{default:Vue.withCtx(()=>[Vue.createTextVNode(" \u641C\u7D22 ")]),_:1})]),Vue.withDirectives(Vue.createElementVNode("div",x,[Vue.createElementVNode("div",y,[P,Vue.withDirectives(Vue.createElementVNode("div",w," \u6682\u65E0\u6587\u4EF6 ",512),[[Vue.vShow,Vue.unref(i).length==0]]),(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(i),(r,p)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"fileItem",key:r.Filename},[Vue.createElementVNode("div",null,Vue.toDisplayString(r.Filename),1),Vue.createElementVNode("div",null,Vue.toDisplayString(r.Filename.split(".")[1]),1),Vue.createElementVNode("div",null,Vue.toDisplayString((r.FileSize/1024).toFixed(2))+"KB",1),Vue.createElementVNode("div",null,[Vue.createVNode(o,{type:"danger",plain:"",size:"small",onClick:g=>f(p)},{default:Vue.withCtx(()=>[Vue.createTextVNode(" \u5220\u9664 ")]),_:2},1032,["onClick"]),r.Filename.split(".")[1]=="zip"?(Vue.openBlock(),Vue.createBlock(o,{key:0,type:"warning",plain:"",size:"small",onClick:g=>_(p)},{default:Vue.withCtx(()=>[Vue.createTextVNode(" \u89E3\u538B ")]),_:2},1032,["onClick"])):Vue.createCommentVNode("",!0)])]))),128))]),Vue.createVNode(d,{ref:"upload",class:"uploadJson",drag:"",accept:".zip,.in,.out",multiple:!0,"auto-upload":!1,"on-change":F,"on-remove":E},{default:Vue.withCtx(()=>[Vue.createVNode(s,{class:"el-icon--upload"},{default:Vue.withCtx(()=>[Vue.createVNode(l)]),_:1}),A]),_:1},512),Vue.createVNode(o,{plain:"",onClick:v,type:"primary"},{default:Vue.withCtx(()=>[Vue.createTextVNode(" \u4E0A\u4F20 ")]),_:1})],512),[[Vue.vShow,Vue.unref(a).isSearched]])])}}});const I=D(k,[["__scopeId","data-v-c1be3697"]]);export{I as default};
