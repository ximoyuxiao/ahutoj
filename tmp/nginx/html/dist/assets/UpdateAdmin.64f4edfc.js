import{c as b,d as f,_ as E}from"./index.de99a551.js";const F=i=>(Vue.pushScopeId("data-v-11b4c338"),i=i(),Vue.popScopeId(),i),g=F(()=>Vue.createElementVNode("div",{class:"UpdateAdmin"},null,-1)),T={class:"userInfo"},B={class:"permissionHead"},D={class:"header"},A={class:"permissionBody"},C={class:"body"},v={class:"select"},h=Vue.defineComponent({__name:"UpdateAdmin",setup(i){const{proxy:l}=Vue.getCurrentInstance(),n=b(),d=f();var m=0,V=20,o=Vue.reactive({list:[],Count:0,gatAdminList:()=>{l.$get("/api/admin/permission/list/?Page="+m+"&Limit="+V).then(e=>{var a=e.data;if(a.code===0){console.log(e.data);const u=a.Data.map(s=>{const t={UID:s.UID,PermissionMap:s.PermissionMap,permissionTabel:[!1,!1,!1,!1,!1,!1]};return o.ParsePermission(t),t});o.list=u,o.Count=a.Count}})},ParsePermission(e){if(console.log(e),(e.PermissionMap&n.AdministratorBit)>0?e.permissionTabel[5]=!0:e.permissionTabel[5]=!1,(e.PermissionMap&n.ProblemAdminBit)>0?e.permissionTabel[5]=e.permissionTabel[4]=!0:e.permissionTabel[4]=!1,(e.PermissionMap&n.ListAdminBit)>0?e.permissionTabel[5]=e.permissionTabel[3]=!0:e.permissionTabel[3]=!1,(e.PermissionMap&n.ContestAdminBit)>0?e.permissionTabel[5]=e.permissionTabel[2]=!0:e.permissionTabel[2]=!1,(e.PermissionMap&n.SourceBorwserBit)>0?e.permissionTabel[5]=e.permissionTabel[1]=!0:e.permissionTabel[1]=!1,(e.PermissionMap&n.SuperAdminBit)>0)for(let a in e.permissionTabel)e.permissionTabel[a]=!0;else e.permissionTabel[0]=!1;console.log(e)},select(e,a){let u=e.permissionTabel[a];if(a==0&&u){for(let s in e.permissionTabel)e.permissionTabel[s]=!0;l.elMessage({message:"\u6CE8\u610F\uFF0C\u4F60\u5C06\u8D4B\u4E88 \u8D85\u7EA7\u7BA1\u7406\u5458 \u6743\u9650\uFF01",type:"warning"})}a==0&&!u&&d.UID==e.UID&&l.elMessage({message:"\u6CE8\u610F\uFF0C\u4F60\u5C06\u53D6\u6D88\u81EA\u5DF1\u7684 \u8D85\u7EA7\u7BA1\u7406\u5458 \u6743\u9650\uFF01",type:"warning"}),a!=0&&!u&&e.permissionTabel[0]&&l.elMessage({message:"\u6CE8\u610F\uFF0C\u4F60\u5C06\u53D6\u6D88 \u8D85\u7EA7\u7BA1\u7406\u5458 \u7684\u6B21\u7EA7\u6743\u9650\uFF0C\u8FD9\u53EF\u80FD\u662F\u65E0\u6548\u7684\uFF01",type:"warning"})},ChangePermission(e){console.log(e),l.$post("api/admin/permission/edit/",{UID:e.UID,SuperAdmin:e.permissionTabel[0],SourceAdmin:e.permissionTabel[1],ContestAdmin:e.permissionTabel[2],ListAdmin:e.permissionTabel[3],ProbelmAdmin:e.permissionTabel[4]}).then(a=>{var s,t;let u=a.data;u.code==0&&l.elMessage({message:"\u4FEE\u6539\u6210\u529F",type:"success"}),l.codeProcessor((s=u==null?void 0:u.code)!=null?s:100001,(t=u==null?void 0:u.msg)!=null?t:"\u670D\u52A1\u5668\u9519\u8BEF\\\\error")})}});return o.gatAdminList(),(e,a)=>{const u=Vue.resolveComponent("el-switch"),s=Vue.resolveComponent("el-button");return Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[g,Vue.createElementVNode("div",T,[Vue.createElementVNode("div",B,[(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(["\u7528\u6237ID","\u8D85\u7BA1","\u8D44\u6E90","\u7ADE\u8D5B","\u9898\u5355","\u9898\u76EE","\u7BA1\u7406\u5458","\u4FEE\u6539\u6743\u9650"],(t,p)=>Vue.createElementVNode("div",D,Vue.toDisplayString(t),1)),64))]),Vue.createElementVNode("div",A,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(o).list,(t,p)=>(Vue.openBlock(),Vue.createElementBlock("div",C,[Vue.createElementVNode("div",null,Vue.toDisplayString(t.UID),1),(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(t.permissionTabel,(_,r)=>(Vue.openBlock(),Vue.createElementBlock("div",v,[Vue.createVNode(u,{modelValue:t.permissionTabel[r],"onUpdate:modelValue":c=>t.permissionTabel[r]=c,onChange:c=>Vue.unref(o).select(t,r),"active-value":!0,"inactive-value":!1},null,8,["modelValue","onUpdate:modelValue","onChange"])]))),256)),Vue.createVNode(s,{class:"botton",onClick:_=>Vue.unref(o).ChangePermission(t)},{default:Vue.withCtx(()=>[Vue.createTextVNode(" \u4FEE\u6539 ")]),_:2},1032,["onClick"])]))),256))])])],64)}}});const k=E(h,[["__scopeId","data-v-11b4c338"]]);export{k as default};
